trainer: nae 
logger: nae
model:
    arch: nae 
    encoder: 
        arch: fc 
        enc_dec: 1
        dropout: false
        l_hidden: [100,100,100]
        nh: 32 
        out_activation: linear 
        activation: relu
        use_bn: false 
        num_groups: 8
    decoder:
        arch: fc 
        nh: 32
        use_bn: false 
        num_groups: 8
        l_hidden: [100,100,100]
        out_activation: linear
        activation: relu
        dropout: False
        enc_dec: 1
    nae:
        spherical: True
        gamma: 1
        sampling: on_manifold

        z_step: 20
        z_stepsize: 100 
        z_noise_std: 0.02
        z_noise_anneal: Null 
        z_clip_langevin_grad: Null
        x_step: 40
        x_stepsize: 100
        x_noise_std: 0.02
        x_noise_anneal: 1
        x_clip_langevin_grad: 0.01

        buffer_size: 10000
        replay_ratio: 0.95
        replay: True
        
        x_bound:
            - 0
            - 1
        z_bound: Null
        l2_norm_reg: Null
        l2_norm_reg_en: Null
        temperature: 1.
        temperature_trainable: False

    x_dim: 28
    z_dim: 3
data:
    indist_train:
        dataset: IDMDH 
        path: /ceph/jeppelt/idmdh_data.csv
        batch_size: 1000
        n_workers: 8
        split: training 
        shuffle: True
        size: 64
        augmentations: 
        
        dequant: 

    indist_val:
        dataset: IDMDH 
        path: /ceph/jeppelt/idmdh_data.csv
        batch_size: 1000
        n_workers: 8
        split: validation 
        size: 64
    ood_val:
        dataset: IDMDH 
        path: /ceph/jeppelt/idmdh_data.csv
        batch_size: 1000
        n_workers: 8
        split: validation 
        size: 64
    ood_target:
        dataset: IDMDH 
        size: 64
        path: /ceph/jeppelt/idmdh_data.csv
        batch_size: 1000
        n_workers: 8
        split: validation
training:
    #load_ae: /ceph/jeppelt/exports/NAE/IDMDH_nae/run/model_best.pkl
    ae_epoch: 25
    nae_epoch: 50
    lr_schedule: null
        # name: on_plateau
        # factor: 0.5
        # patience: 3
        # min_lr: 1.0e-4
    resume: null
        # file: /a/b/c.pkl
        # optimizer: False 
    print_interval: 100
    val_interval: 200
    save_interval: 2000
    ae_lr: 1.0e-4
    nae_lr: 1.0e-5
    temperature_lr: 1.0e-3
    fix_D: false 
